<!--suppress PluginXmlCapitalization -->
<idea-plugin>
    <id>com.wanggaowan.tools</id>
    <name>FlutterDevTools</name>
    <vendor email="wanggaowan@163.com" url="https://github.com/wanggaowan/FlutterDevTools.git" />

    <description><![CDATA[
    <h2>提供Flutter开发所需工具</h2>
    <ol>
      <li>项目结构增加Flutter项目专属分类</li>
      <li>图片资源管理窗口</li>
      <li>json转dart</li>
      <li>一键导入android图片</li>
      <li>复制/删除/重命名不同分辨率下的相同图片</li>
      <li>自动/手动生成图片资源引用文件并配置assets节点</li>
      <li>实时显示多语言翻译后文本</li>
      <li>常用命令提供快捷方式</li>
      <li>文件导航</li>
      <li>页面路由配置</li>
      <li>Android &lt;string/&gt;转化arb文件格式</li>
    </ol>
    ]]></description>

    <change-notes><![CDATA[
    <p>2.4</p>
    <ul>
       <li>修复执行'生成类序列化方法'命令时，创建构造函数，未将static、const和已经有初始值的final字段排除Bug</li>
       <li>图片多分辨率操作增加到编辑器tab页右键操作中</li>
    </ul>

    <p>2.3</p>
    <ul>
       <li>粘贴android <string/>文本转化为flutter多语言文本，占位符转化支持简单模式</li>
       <li>优化图片资源管理窗口，解决图片数量巨大的情况下使用卡顿问题</li>
    </ul>

    <p>2.2</p>
    <ul>
       <li>增加android屏幕尺寸px，dp转换文档说明</li>
    </ul>

    <p>2.1</p>
    <ul>
       <li>插件最低支持IDE版本升级到223</li>
       <li>增加arb文件类型解析规则</li>
    </ul>

    <p>2.0</p>
    <ul>
      <li>页面路由配置：增加返回参数，路由根据光标位置智能插入到相邻路由之下，而不是总是插入到尾部</li>
      <li>增加粘贴Android &lt;string/&gt; 文本到arb文件时，自动转化为arb文本格式</li>
      <li>根据路由地址跳转，可选择跳转到定义处还是路由界面</li>
    </ul>

    <p>1.9</p>
    <ul>
      <li>增加配置页面路由功能</li>
      <li>增加重命名不同分辨率下的相同图片功能</li>
      <li>路由配置界面，可点击路由地址跳转对应的界面</li>
    </ul>

    <p>1.8</p>
    <ul>
      <li>修复生成图片引用资源并配置yaml assets节点数据时，assets会多追加换行，导致assets节点下出现大量空白行Bug</li>
      <li>修复图片资源预览未去重不同分辨率下相同图片Bug</li>
      <li>增加Flutter Intl插件依赖，方便l10n多语言引用跳转到对应的定义位置</li>
    </ul>

    <p>1.7</p>
    <ul>
      <li>修复json to dart Bug</li>
      <li>json to dart 配置converts选项默认选中，converts值默认为nullFieldConvertList</li>
    </ul>

    <p>1.6</p>
    <ul>
      <li>修复一些已知缺陷</li>
    </ul>

    <p>1.5</p>
    <ul>
      <li>支持一个项目多个Flutter模块工程模式</li>
    </ul>

    <p>1.4</p>
    <ul>
      <li>增加一键删除相同名称但不同分辨率文件夹下多张图片功能</li>
      <li>自定义图片资源文档注释</li>
      <li>图片引用资源文件在序号栏展示对应图片Icon</li>
    </ul>

    <p>1.3</p>
    <ul>
      <li>支持开发Flutter插件项目时多项目结构(插件根目录下存在example项目)，gen-l10n命令，生成资源引用文件命令等会根据不同项目执行在不同上下文中</li>
      <li>拖拽或粘贴导入图片支持drawable，mipmap目录在第一级，无需将其包裹在一个父级目录下</li>
    </ul>

    <p>1.2</p>
    <ul>
      <li>支持拖拽或粘贴文件方式导入图片</li>
      <li>自动监测多语言变更，自动执行gen-l10n命令</li>
      <li>自动监测图片资源变更，自动生成图片资源引用和配置assets节点</li>
      <li>增加复制不同分辨率下的相同图片功能</li>
    </ul>

    <p>1.1</p>
    <ul>
      <li>增加生成图片资源引用文件并配置assets节点功能</li>
      <li>增加实时显示多语言翻译后文本功能</li>
      <li>增加执行gen-l10n快捷方式</li>
    </ul>

    <p>1.0</p>
    <ul>
      <li>项目结构增加Flutter项目专属分类，仅展示Flutter开发重点关注文件</li>
      <li>提供json转dart并支持序列化</li>
      <li>提供一键执行dart序列化/开启序列化观察者命令</li>
      <li>提供一键导入android图片目录结构文件到Flutter</li>
      <li>提供flutter图片资源管理ToolWindow</li>
    </ul>
    ]]>
    </change-notes>

    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.lang</depends>
    <depends>Dart</depends>
    <depends>io.flutter</depends>
    <depends>org.jetbrains.plugins.yaml</depends>

    <actions>
        <action id="FlutterDevTools.DoL10nAction2"
            class="com.wanggaowan.tools.actions.DoL10nAction2" text="gen-l10n"
            description="执行flutter gen-l10n命令">
            <add-to-group group-id="GenerateGroup" anchor="last" />
        </action>
        <action id="FlutterDevTools.JsonToDart"
            class="com.wanggaowan.tools.actions.JsonToDartAction" text="Json To Dart"
            description="Json convert to dart">
            <add-to-group group-id="GenerateGroup" anchor="last" />
        </action>
        <action id="FlutterDevTools.GeneratorJsonSerializableAction"
            class="com.wanggaowan.tools.actions.GeneratorClassSerializableMethodAction"
            text="生成类序列化方法" description="Json convert to dart">
            <add-to-group group-id="GenerateGroup" anchor="last" />
        </action>
        <action id="FlutterDevTools.GeneratorSingleGFileAction"
            class="com.wanggaowan.tools.actions.GeneratorSingleGFileAction" text="生成 .g.dart"
            description="根据Dart实体生成.g.dart文件">
            <add-to-group group-id="GenerateGroup" anchor="last" />
        </action>
        <action id="FlutterDevTools.AddRouterAction"
            class="com.wanggaowan.tools.actions.AddRouterAction" text="添加页面路由"
            description="根据给定内容，生成路由数据">
            <add-to-group group-id="GenerateGroup" anchor="last" />
        </action>

        <group id="FlutterDevToolsActionGroup"
            class="com.wanggaowan.tools.actions.ToolsActionGroup">
            <separator />
            <action id="FlutterDevTools.DoL10nAction"
                class="com.wanggaowan.tools.actions.DoL10nAction" text="gen-l10n"
                description="执行flutter gen-l10n命令" />
            <separator />
            <action id="FlutterDevTools.GeneratorGFileAction"
                class="com.wanggaowan.tools.actions.GeneratorGFileAction" text="生成 .g.dart"
                description="根据Dart实体生成.g.dart文件" />
            <action id="FlutterDevTools.JsonSerializableWatcher"
                class="com.wanggaowan.tools.actions.JsonSerializableWatcherAction"
                text="开启自动生成.g.dart文件服务"
                description="开启根据Dart实体生成.g.dart文件观察者" />
            <separator />
            <action id="FlutterDevTools.ImportSameImageResAction"
                class="com.wanggaowan.tools.actions.ImportSameImageResAction"
                text="导入不同分辨率下的相同图片"
                description="导入 android drawable目录结构不同分辨率下的多张图片" />
            <action id="FlutterDevTools.GeneratorImageRefAction"
                class="com.wanggaowan.tools.actions.GeneratorImageRefAction"
                text="生成图片资源引用文件并配置yaml assets节点"
                description="生成图片资源引用文件并配置pubspec.yaml assets节点" />
            <add-to-group group-id="FlutterToolsActionGroup" anchor="last" />
        </group>

        <group id="FlutterDevToolsImageOperationActionGroup"
            class="com.wanggaowan.tools.actions.ImageOperationActionGroup">
            <separator />
            <action id="FlutterDevTools.CopyMultiSameNameFileAction"
                class="com.wanggaowan.tools.actions.CopyMultiSameNameFileAction"
                text="复制不同分辨率下的相同图片" icon="FlutterIcons.Flutter_13"
                description="复制不同分辨率下的相同图片" />
            <action id="FlutterDevTools.DeleteMultiSameNameFileAction"
                class="com.wanggaowan.tools.actions.DeleteMultiSameNameFileAction"
                text="删除不同分辨率下的相同图片" icon="FlutterIcons.Flutter_13"
                description="删除不同分辨率下的相同图片" />
            <action id="FlutterDevTools.RenameMultiSameNameFileAction"
                class="com.wanggaowan.tools.actions.RenameMultiSameNameFileAction"
                text="重命名不同分辨率下的相同图片" icon="FlutterIcons.Flutter_13"
                description="重命名不同分辨率下的相同图片" />
            <separator />
            <add-to-group group-id="CutCopyPasteGroup" anchor="last" />
            <add-to-group group-id="EditorTabPopupMenu" relative-to-action="SplitVertically"
                anchor="before" />
        </group>
    </actions>

    <applicationListeners>
        <listener class="com.wanggaowan.tools.listener.ProjectManagerListenerImpl"
            topic="com.intellij.openapi.project.ProjectManagerListener" />
        <listener class="com.wanggaowan.tools.listener.GenL10nListener"
            topic="com.intellij.openapi.fileEditor.FileEditorManagerListener" />
        <listener class="com.wanggaowan.tools.listener.GeneratorImageRefListener"
            topic="com.intellij.openapi.vfs.newvfs.BulkFileListener" />
    </applicationListeners>

    <extensions defaultExtensionNs="com.intellij">
        <notificationGroup displayType="BALLOON" id="com.wanggaowan.tools.notification"
            isLogByDefault="false" />

        <postStartupActivity implementation="com.wanggaowan.tools.ProjectOpenActivity" />

        <!--必须设置order为first，否则2021.3版本之后不会调用FlutterGoToDeclarationHandler-->
        <gotoDeclarationHandler
            implementation="com.wanggaowan.tools.extensions.gotohandler.FlutterGoToDeclarationHandler"
            order="first" />

        <lang.documentationProvider language="Dart"
            implementationClass="com.wanggaowan.tools.extensions.description.ImageDocumentDescriptionProvider"
            order="first" />

        <lang.documentationProvider
            implementationClass="com.wanggaowan.tools.extensions.description.ScreenSizeDocumentDescriptionProvider"
            order="first" language="XML" id="ssdxml" />
        <lang.documentationProvider
            implementationClass="com.wanggaowan.tools.extensions.description.ScreenSizeDocumentDescriptionProvider"
            order="after ssdxml" language="JAVA" id="ssdjava" />
        <lang.documentationProvider
            implementationClass="com.wanggaowan.tools.extensions.description.ScreenSizeDocumentDescriptionProvider"
            order="after ssdjava" language="kotlin" />

        <projectViewPane
            implementation="com.wanggaowan.tools.extensions.projectviewpane.FlutterProjectViewPane"
            id="FlutterDevTools.ProjectViewPane" />

        <toolWindow id="Flutter Resource Manager"
            factoryClass="com.wanggaowan.tools.extensions.toolwindow.ResourcePreviewToolWindowFactory"
            icon="FlutterIcons.Flutter_13" />

        <projectConfigurable parentId="tools"
            instance="com.wanggaowan.tools.settings.ProjectPluginSettingsConfigurable"
            id="FlutterDevTools.ProjectPluginSettingsConfigurable" displayName="FlutterDevTools" />

        <codeInsight.lineMarkerProvider language="Dart"
            implementationClass="com.wanggaowan.tools.extensions.codeInsight.ImageLineMarkerProvider" />

        <lang.foldingBuilder language="Dart"
            implementationClass="com.wanggaowan.tools.extensions.lang.I18nFoldingBuilder" />

        <actionOnSave implementation="com.wanggaowan.tools.listener.GenL10nListener" order="last" />

        <filePasteProvider implementation="com.wanggaowan.tools.listener.ImportSameImageListener"
            order="first" />
        <refactoring.moveHandler
            implementation="com.wanggaowan.tools.listener.ImportSameImageListener" order="first" />

        <customPasteProvider
            implementation="com.wanggaowan.tools.extensions.AndroidStringPasteProvider" />

        <fileType name="ARB" extensions="arb" language="JSON"
            implementationClass="com.wanggaowan.tools.extensions.filetype.ArbFileType" />
    </extensions>

</idea-plugin>
